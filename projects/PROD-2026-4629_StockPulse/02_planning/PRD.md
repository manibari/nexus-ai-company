# StockPulse 產品需求文件 (PRD)

## 1. 產品概述

### 1.1 產品名稱
StockPulse - 智能股票分析平台

### 1.2 產品定位
為投資者提供即時報價、技術分析、基本面分析、AI 智能選股與回測功能的一站式股票分析工具。

### 1.3 目標用戶
- 個人投資者
- 技術分析愛好者
- 量化交易初學者

---

## 2. 功能需求

### 2.1 股票搜尋 (P0 - 必要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-001 | 支援股票代碼搜尋 | 輸入 "AAPL" 可找到 Apple Inc. |
| F-002 | 支援公司名稱搜尋 | 輸入 "Apple" 可找到 AAPL |
| F-003 | 支援多市場 | 美股、台股 (.TW)、港股 (.HK) |
| F-004 | 自動完成建議 | 輸入時顯示匹配結果 |

### 2.2 即時報價 (P0 - 必要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-010 | 顯示當前價格 | 數值正確，格式為 $XXX.XX |
| F-011 | 顯示漲跌幅 | 正數綠色+號，負數紅色 |
| F-012 | 顯示成交量 | 數值使用千分位格式 |
| F-013 | 顯示市值 | 自動換算 B/T 單位 |
| F-014 | 顯示 52 週高低 | 顯示最高與最低價 |

### 2.3 K 線圖表 (P0 - 必要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-020 | 顯示 K 線圖 | OHLC 蠟燭圖正確顯示 |
| F-021 | 顯示成交量 | 柱狀圖於圖表下方 |
| F-022 | 時間週期切換 | 支援 1M/3M/6M/1Y/2Y/5Y |
| F-023 | 圖表縮放 | 滑鼠滾輪可縮放 |
| F-024 | 圖表拖曳 | 滑鼠拖曳可平移 |

### 2.4 技術指標 (P1 - 重要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-030 | SMA 均線 | 顯示 20/50/200 日均線 |
| F-031 | RSI 指標 | 14 日 RSI，標示超買超賣區 |
| F-032 | MACD 指標 | 顯示 MACD/Signal/Histogram |
| F-033 | 布林通道 | 顯示上中下軌 |
| F-034 | KD 隨機指標 | 顯示 %K/%D 值 |
| F-035 | 指標訊號判讀 | 文字說明多空訊號 |

### 2.5 基本面資料 (P1 - 重要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-040 | 估值指標 | P/E, P/B, P/S, PEG |
| F-041 | 獲利能力 | ROE, ROA, 利潤率 |
| F-042 | 成長指標 | 營收成長率、獲利成長率 |
| F-043 | 股息資訊 | 殖利率、配發率 |
| F-044 | 財務健康 | 流動比率、負債比 |
| F-045 | 分析師評級 | 目標價、買賣建議 |

### 2.6 AI 分析 (P1 - 重要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-050 | 綜合分析 | 結合技術面+基本面分析 |
| F-051 | 多空因素列表 | 分點列出利多利空 |
| F-052 | 風險提示 | 列出潛在風險 |
| F-053 | 操作建議 | 買入/持有/賣出/觀望 |
| F-054 | 信心程度 | 顯示 AI 信心百分比 |
| F-055 | 關鍵價位 | 支撐與壓力位 |
| F-056 | AI 選股 | 依條件推薦股票 |

### 2.7 策略回測 (P2 - 次要)

| ID | 需求 | 驗收標準 |
|----|------|----------|
| F-060 | SMA 交叉策略 | 快慢均線交叉買賣 |
| F-061 | RSI 反轉策略 | 超賣買入、超買賣出 |
| F-062 | 回測報告 | 總報酬、年化報酬 |
| F-063 | 風險指標 | 最大回撤、夏普比率 |
| F-064 | 交易明細 | 買賣時間點與損益 |
| F-065 | 權益曲線 | 資產變化圖表 |

---

## 3. 非功能需求

### 3.1 效能需求
- 搜尋回應 < 500ms
- 圖表載入 < 2s
- API 回應 < 3s

### 3.2 相容性需求
- 支援 Chrome, Safari, Firefox 最新版
- 響應式設計（桌面優先）

### 3.3 資料來源
- Yahoo Finance API（延遲 15 分鐘）
- 技術指標本地計算

---

## 4. 資料需求（必填章節）

> **注意：** 此章節為原 PRD 遺漏，後續補充。
> 參考 `docs/protocols/data_architecture_checklist.md`

### 4.1 資料來源評估

| 資料類型 | 來源 | 方式 | 限制 | 成本 |
|----------|------|------|------|------|
| 即時報價 | Yahoo Finance | yfinance API | 15分鐘延遲 | 免費 |
| 歷史 K 線 | Yahoo Finance | yfinance API | 日限額未知 | 免費 |
| 基本面 | Yahoo Finance | yfinance API | 即時 | 免費 |
| AI 分析 | Claude API | REST API | Token 計費 | 付費 |

### 4.2 資料更新頻率

| 資料類型 | 更新頻率 | 觸發方式 | 優先級 |
|----------|----------|----------|--------|
| 即時報價 | 即時 | 用戶請求 | P0 |
| 日 K 線 | 每日收盤後 | 排程任務 | P1（MVP 後） |
| 基本面 | 每季 | 排程任務 | P2 |
| 技術指標 | 隨 K 線更新 | 計算 | P0 |

### 4.3 資料保留政策

| 資料類型 | 保留期限 | 儲存方案 | 備註 |
|----------|----------|----------|------|
| 日 K 線 | 永久 | DB（P1） | MVP 使用快取 |
| 用戶 Watchlist | 永久 | DB（P2） | MVP 不支援 |
| 回測結果 | 90 天 | DB（P2） | MVP 不保留 |
| API 快取 | 15 分鐘 | Redis/Memory | MVP 使用 Memory |

### 4.4 MVP 資料架構決策

| 項目 | MVP 實作 | 正式版建議 |
|------|----------|------------|
| 快取 | In-Memory (TTL 15min) | Redis |
| 持久化 | 無 | PostgreSQL + TimescaleDB |
| 排程 | 無 | Celery + Redis |
| 用戶資料 | 無 | PostgreSQL |

**MVP 限制說明：**
- 重啟後快取遺失
- 無歷史資料累積
- 高頻請求可能觸發 API 限額

---

## 5. 版本規劃

| 版本 | 功能範圍 | 預計完成 |
|------|----------|----------|
| MVP 0.1 | F-001~F-024 (搜尋、報價、K線) | Sprint 1 |
| v0.2 | F-030~F-045 (指標、基本面) | Sprint 2 |
| v0.3 | F-050~F-065 (AI、回測) | Sprint 3 |

---

## 5. 驗收簽核

| 角色 | 姓名 | 日期 | 簽核 |
|------|------|------|------|
| PM | - | - | ⬜ |
| Dev Lead | - | - | ⬜ |
| QA Lead | - | - | ⬜ |
